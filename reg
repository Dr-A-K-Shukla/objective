<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Save to Google Sheet</title>
<style>
  body { font-family: Arial; background: #f9f9f9; text-align:center; padding:40px; }
  input { margin: 8px; padding: 8px; width: 200px; }
  button { padding: 10px 20px; cursor: pointer; }
</style>
</head>
<body>
  <h2>Submit Data to Google Sheet</h2>
  <input type="text" id="name" placeholder="Name"><br>
  <input type="text" id="class" placeholder="Class"><br>
  <input type="number" id="score" placeholder="Score"><br>
  <input type="number" id="total" placeholder="Total"><br>
  <button onclick="submitData()">Submit</button>

  <p id="msg"></p>

  <script>
    async function submitData() {
      const data = {
        Name: document.getElementById('name').value,
        Class: document.getElementById('class').value,
        Score: document.getElementById('score').value,
        Total: document.getElementById('total').value
      };

      document.getElementById('msg').innerText = "Saving...";

      try {
        const res = await fetch("https://script.google.com/macros/s/AKfycbycYFsgJR6B7n563uRZlggR4C6SFQdBt0og89cnB6uN8YYdvF2wmAheJowk-GIDCD_d/exec", {
          method: "POST",
          body: JSON.stringify(data),
          headers: { "Content-Type": "application/json" }
        });

        const result = await res.json();
        if (result.status === "success") {
          document.getElementById('msg').innerText = "✅ Data saved successfully!";
        } else {
          document.getElementById('msg').innerText = "⚠️ Error: " + result.message;
        }
      } catch (err) {
        document.getElementById('msg').innerText = "❌ Network error: " + err.message;
      }
    }
  </script>
</body>
</html>
